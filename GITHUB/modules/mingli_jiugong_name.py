#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ä¹å®®å§“åå­¸åˆ†æå™¨ï¼ˆä¸­åœ‹å‚³çµ±å§“åå­¸ï¼‰
åŸºæ–¼å§“åç­†ç•«æ•¸è¨ˆç®—å¤©æ ¼ã€åœ°æ ¼ã€äººæ ¼ã€å¤–æ ¼ã€ç¸½æ ¼
åˆ¤æ–·äº”è¡Œå±¬æ€§å’Œå‰å‡¶é‹å‹¢
"""


class JiuGongNameAnalyzer:
    """ä¹å®®å§“åå­¸åˆ†æå™¨"""
    
    def __init__(self):
        """åˆå§‹åŒ–ä¹å®®å§“åå­¸åˆ†æå™¨"""
        # å¸¸ç”¨æ¼¢å­—ç­†ç•«æ•¸å°ç…§è¡¨ï¼ˆåº·ç†™å­—å…¸ç­†ç•«ï¼‰
        self.stroke_dict = self._init_stroke_dict()
        
        # æ•¸å­—äº”è¡Œå°ç…§
        self.wuxing_map = {
            1: "æœ¨", 2: "æœ¨", 3: "ç«", 4: "ç«", 5: "åœŸ",
            6: "åœŸ", 7: "é‡‘", 8: "é‡‘", 9: "æ°´", 0: "æ°´"
        }
        
        # æ•¸å­—å‰å‡¶å°ç…§ï¼ˆ81æ•¸ç†å‰å‡¶ï¼‰
        self.luck_map = self._init_luck_map()
    
    def _init_stroke_dict(self):
        """åˆå§‹åŒ–å¸¸ç”¨å­—ç­†ç•«æ•¸å°ç…§è¡¨"""
        strokes = {
            # å§“æ°
            'ç‹': 4, 'æ': 7, 'å¼µ': 11, 'åŠ‰': 15, 'é™³': 16, 'æ¥Š': 13, 'é»ƒ': 12, 'è¶™': 14,
            'å‘¨': 8, 'å³': 7, 'å¾': 10, 'å­«': 10, 'é¦¬': 10, 'æœ±': 6, 'èƒ¡': 11, 'éƒ­': 15,
            'æ—': 8, 'ä½•': 7, 'é«˜': 10, 'æ¢': 11, 'é„­': 19, 'ç¾…': 20, 'å®‹': 7, 'è¬': 17,
            'å”': 10, 'éŸ“': 17, 'æ›¹': 11, 'è¨±': 11, 'é„§': 19, 'è•­': 19, 'é¦®': 12, 'æ›¾': 12,
            'ç¨‹': 12, 'è”¡': 17, 'å½­': 12, 'æ½˜': 16, 'è¢': 10, 'äº': 3, 'è‘£': 15, 'ä½™': 7,
            'è˜‡': 22, 'è‘‰': 15, 'å‘‚': 7, 'é­': 18, 'è”£': 17, 'ç”°': 5, 'æœ': 7, 'ä¸': 2,
            'æ²ˆ': 8, 'å§œ': 9, 'èŒƒ': 11, 'æ±Ÿ': 7, 'å‚…': 12, 'é˜': 20, 'ç›§': 16, 'æ±ª': 8,
            'æˆ´': 18, 'å´”': 11, 'ä»»': 6, 'é™¸': 16, 'å»–': 15, 'å§š': 9, 'æ–¹': 4, 'é‡‘': 8,
            'é‚±': 12, 'å¤': 10, 'è­š': 19, 'éŸ‹': 9, 'è³ˆ': 13, 'é„’': 17, 'çŸ³': 5, 'ç†Š': 14,
            'å­Ÿ': 8, 'ç§¦': 10, 'é–»': 16, 'è–›': 19, 'ä¾¯': 9, 'é›·': 13, 'ç™½': 5, 'é¾': 16,
            'æ®µ': 9, 'éƒ': 14, 'å­”': 4, 'é‚µ': 12, 'å²': 5, 'æ¯›': 4, 'å¸¸': 11, 'è¬': 15,
            'é¡§': 21, 'è³´': 16, 'æ­¦': 8, 'åº·': 11, 'è³€': 12, 'åš´': 20, 'å°¹': 4, 'éŒ¢': 16,
            
            # å¸¸ç”¨åå­—
            'æ˜': 8, 'è¯': 14, 'å¼·': 12, 'å‰': 11, 'èŠ³': 10, 'å¨œ': 10, 'éº—': 19, 'è»': 9,
            'å‚‘': 12, 'æ•': 11, 'éœ': 16, 'éº—': 19, 'å‹‡': 9, 'ç§€': 7, 'è‹±': 11, 'å¨Ÿ': 10,
            'ç²': 10, 'é£›': 9, 'ç´…': 9, 'é›ª': 11, 'æ¢…': 11, 'éœ': 17, 'è¼': 15, 'éµ¬': 19,
            'æ¿¤': 18, 'é‘«': 24, 'ç£Š': 15, 'è•¾': 19, 'æµ©': 11, 'å®‡': 6, 'æ–‡': 4, 'é¾': 16,
            'å©·': 12, 'ç©': 16, 'å†¬': 5, 'é›¨': 8, 'è˜­': 23, 'é³³': 14, 'é›²': 12, 'ç´': 13,
            'ç‡•': 16, 'å½¬': 11, 'è': 14, 'äº®': 9, 'å‰›': 10, 'æ³¢': 9, 'å¹³': 5, 'æ¾': 8,
            'æ…§': 15, 'è‰·': 24, 'ä½³': 8, 'æ¬£': 8, 'æ—­': 6, 'å¸†': 6, 'éº—': 19, 'è¶…': 12,
            'å»º': 9, 'åœ‹': 11, 'å®‰': 6, 'å¿—': 7, 'æ±Ÿ': 7, 'å±±': 3, 'ä¸¹': 4, 'é’': 8,
            'æ—': 8, 'æ™¨': 11, 'é™½': 17, 'é¢¨': 9, 'æœˆ': 4, 'æ˜Ÿ': 9, 'å¤©': 4, 'æµ·': 11,
            'æ˜¥': 9, 'å¤': 10, 'ç§‹': 9, 'å†¬': 5, 'æ¢“': 11, 'æ¶µ': 12, 'çª': 13, 'ç‘¤': 15,
            'è±': 15, 'è–‡': 19, 'å€©': 10, 'èŒ¹': 12, 'è‰': 13, 'å©•': 11, 'å«»': 15, 'çŠ': 10,
            'è“‰': 16, 'ç’‡': 16, 'ç³': 13, 'è»’': 10, 'å®¸': 10, 'æ¾¤': 17, 'ç¿': 14, 'æ˜Š': 8,
            'ç…œ': 13, 'ç‚«': 9, 'éŠ˜': 14, 'æ™Ÿ': 11, 'çš“': 12, 'åš': 12, 'ç€š': 20, 'å‡±': 12,
            'ä¿Š': 9, 'å³°': 10, 'æ¥“': 13, 'æ™': 12, 'æ™´': 12, 'æ›¦': 20, 'é™½': 17, 'éœ–': 16,
            'éœ„': 15, 'å®': 7, 'è¾°': 7, 'å½¥': 9, 'æ³“': 9, 'æ˜±': 9, 'æ£Ÿ': 12, 'æ¨º': 16,
            'ç‘‹': 14, 'éˆ': 12, 'ç¿': 14, 'å“²': 10, 'è»’': 10, 'å®‡': 6, 'æ¾¤': 17, 'è±ª': 14,
            
            # å¸¸ç”¨å­—
            'ä¸€': 1, 'äºŒ': 2, 'ä¸‰': 3, 'å››': 5, 'äº”': 4, 'å…­': 4, 'ä¸ƒ': 2, 'å…«': 2,
            'ä¹': 2, 'å': 2, 'ç™¾': 6, 'åƒ': 3, 'è¬': 15, 'å„„': 15, 'å…†': 6,
            'å°': 3, 'å¤§': 3, 'ä¸­': 4, 'ä¹‹': 4, 'å­': 3, 'äºº': 2, 'å¿ƒ': 4, 'æ‰‹': 4,
            'æ—¥': 4, 'æœˆ': 4, 'æ°´': 4, 'ç«': 4, 'æœ¨': 4, 'é‡‘': 8, 'åœŸ': 3, 'çŸ³': 5,
            'ç”°': 5, 'å±±': 3, 'å·': 3, 'æ²³': 9, 'æ¹–': 13, 'æµ·': 11, 'é›¨': 8, 'é›ª': 11,
            'é¢¨': 9, 'é›²': 12, 'å¤©': 4, 'åœ°': 6, 'æ±': 8, 'è¥¿': 6, 'å—': 9, 'åŒ—': 5,
            'ä¸Š': 3, 'ä¸‹': 3, 'å·¦': 5, 'å³': 5, 'å‰': 9, 'å¾Œ': 9, 'å…§': 4, 'å¤–': 5,
            'å®¶': 10, 'åœ‹': 11, 'åŸ': 10, 'é„‰': 13, 'æ‘': 7, 'é‡Œ': 7, 'è¡—': 12, 'è·¯': 13,
            'é–€': 8, 'æˆ¶': 4, 'çª—': 12, 'æˆ¿': 8, 'å±‹': 9, 'æ¨“': 15, 'å°': 5, 'äº­': 9,
        }
        return strokes
    
    def _init_luck_map(self):
        """åˆå§‹åŒ–81æ•¸ç†å‰å‡¶å°ç…§è¡¨"""
        luck = {}
        
        # å¤§å‰æ•¸
        great_luck = [1, 3, 5, 6, 7, 8, 11, 13, 15, 16, 17, 18, 21, 23, 24, 25, 
                      29, 31, 32, 33, 35, 37, 39, 41, 45, 47, 48, 52, 57, 61, 
                      63, 65, 67, 68, 81]
        
        # å‰æ•¸
        good_luck = [2, 36, 38, 40, 42, 43, 44, 46, 50, 51, 53, 55, 58, 71, 73, 75]
        
        # åŠå‰æ•¸
        half_luck = [26, 27, 30, 49, 54, 56, 59, 60, 62, 64, 66, 69, 70, 72, 74, 
                     76, 77, 78, 79, 80]
        
        # å‡¶æ•¸
        bad_luck = [4, 9, 10, 12, 14, 19, 20, 22, 28, 34]
        
        for i in range(1, 82):
            if i in great_luck:
                luck[i] = "å¤§å‰"
            elif i in good_luck:
                luck[i] = "å‰"
            elif i in half_luck:
                luck[i] = "åŠå‰"
            elif i in bad_luck:
                luck[i] = "å‡¶"
            else:
                luck[i] = "å¹³"
        
        return luck
    
    def get_stroke_count(self, char):
        """ç²å–å–®å€‹å­—çš„ç­†ç•«æ•¸"""
        if char in self.stroke_dict:
            return self.stroke_dict[char]
        else:
            # å¦‚æœå­—å…¸ä¸­æ²’æœ‰ï¼Œä½¿ç”¨ç°¡å–®ä¼°ç®—ï¼ˆå¯¦éš›æ‡‰è©²æŸ¥åº·ç†™å­—å…¸ï¼‰
            return len(char) * 6  # ç²—ç•¥ä¼°è¨ˆ
    
    def get_name_strokes(self, name):
        """ç²å–å§“åå„å­—çš„ç­†ç•«æ•¸"""
        if not name:
            return []
        
        strokes = []
        for char in name:
            if char.strip():  # å¿½ç•¥ç©ºæ ¼
                strokes.append(self.get_stroke_count(char))
        
        return strokes
    
    def calculate_tiange(self, strokes):
        """è¨ˆç®—å¤©æ ¼ï¼ˆå§“æ°ç­†ç•«+1ï¼Œè¤‡å§“å‰‡ç›¸åŠ ï¼‰"""
        if not strokes:
            return 0
        
        if len(strokes) == 1:
            # å–®å­—å§“
            return strokes[0] + 1
        else:
            # è¤‡å§“æˆ–å§“å
            return strokes[0] + 1
    
    def calculate_dige(self, strokes):
        """è¨ˆç®—åœ°æ ¼ï¼ˆåå­—ç­†ç•«ç›¸åŠ ï¼Œå–®åå‰‡+1ï¼‰"""
        if len(strokes) <= 1:
            return strokes[0] + 1 if strokes else 2
        elif len(strokes) == 2:
            # å–®å§“å–®å
            return strokes[1] + 1
        elif len(strokes) == 3:
            # å–®å§“é›™å
            return strokes[1] + strokes[2]
        else:
            # è¤‡å§“æˆ–æ›´å¤šå­—
            return sum(strokes[2:]) if len(strokes) > 2 else strokes[-1] + 1
    
    def calculate_renge(self, strokes):
        """è¨ˆç®—äººæ ¼ï¼ˆå§“æ°æœ€å¾Œä¸€å­—+åå­—ç¬¬ä¸€å­—ï¼‰"""
        if len(strokes) <= 1:
            return strokes[0] + 1 if strokes else 2
        elif len(strokes) == 2:
            return strokes[0] + strokes[1]
        else:
            return strokes[0] + strokes[1]
    
    def calculate_waige(self, strokes):
        """è¨ˆç®—å¤–æ ¼ï¼ˆç¸½æ ¼-äººæ ¼+1ï¼Œæˆ–å§“åé¦–å°¾ç›¸åŠ ï¼‰"""
        if len(strokes) <= 2:
            return 2  # å–®åå¤–æ ¼ç‚º2
        else:
            # ç°¡åŒ–è¨ˆç®—ï¼šé¦–å­—+å°¾å­—
            return strokes[0] + strokes[-1]
    
    def calculate_zongge(self, strokes):
        """è¨ˆç®—ç¸½æ ¼ï¼ˆå§“åå…¨éƒ¨ç­†ç•«ç›¸åŠ ï¼‰"""
        return sum(strokes) if strokes else 0
    
    def get_wuxing(self, number):
        """ç²å–æ•¸å­—å°æ‡‰çš„äº”è¡Œ"""
        last_digit = number % 10
        return self.wuxing_map.get(last_digit, "åœŸ")
    
    def get_luck(self, number):
        """ç²å–æ•¸å­—çš„å‰å‡¶"""
        if number > 81:
            number = number % 81
        if number == 0:
            number = 81
        return self.luck_map.get(number, "å¹³")
    
    def get_detailed_meaning(self, ge_type, number):
        """ç²å–å„æ ¼çš„è©³ç´°å«ç¾©"""
        meanings = {
            "å¤©æ ¼": {
                "description": "ä»£è¡¨ç¥–æ¥­ã€çˆ¶æ¯ã€é•·è¼©ï¼Œå½±éŸ¿äººçš„æ—©å¹´é‹å‹¢å’Œå®¶ä¸–èƒŒæ™¯",
                "influence": "å¤©æ ¼ç‚ºå…ˆå¤©é‹ï¼Œç”±å§“æ°æ±ºå®šï¼Œç„¡æ³•æ”¹è®Šï¼Œå½±éŸ¿é’å¹´å‰çš„é‹å‹¢"
            },
            "åœ°æ ¼": {
                "description": "ä»£è¡¨åŸºç¤é‹ã€é…å¶ã€å­å¥³ï¼Œå½±éŸ¿36æ­²å‰çš„é‹å‹¢",
                "influence": "åœ°æ ¼ç‚ºå‰é‹ï¼Œä¸»å°é’å¹´æ™‚æœŸçš„é‹å‹¢ï¼Œé—œä¿‚æ„Ÿæƒ…ã€å¥åº·ã€å®¶åº­"
            },
            "äººæ ¼": {
                "description": "ä»£è¡¨å€‹æ€§ã€æ‰èƒ½ã€äº‹æ¥­ï¼Œæ˜¯å§“åçš„æ ¸å¿ƒï¼Œå½±éŸ¿ä¸­å¹´é‹å‹¢",
                "influence": "äººæ ¼ç‚ºä¸»é‹ï¼Œæ±ºå®šäººçš„æ€§æ ¼ã€èƒ½åŠ›å’Œäººç”Ÿæˆå°±ï¼Œæœ€ç‚ºé‡è¦"
            },
            "å¤–æ ¼": {
                "description": "ä»£è¡¨ç¤¾äº¤ã€äººéš›ã€å¤–åœ¨ç’°å¢ƒï¼Œå½±éŸ¿äººçš„ç¤¾æœƒé—œä¿‚",
                "influence": "å¤–æ ¼ç‚ºå‰¯é‹ï¼Œä¸»å°äººéš›é—œä¿‚ã€ç¤¾äº¤èƒ½åŠ›å’Œå¤–åœ¨æ©Ÿé‡"
            },
            "ç¸½æ ¼": {
                "description": "ä»£è¡¨ä¸€ç”Ÿç¸½é«”é‹å‹¢ï¼Œå½±éŸ¿ä¸­å¹´å¾ŒæœŸè‡³æ™šå¹´çš„å‘½é‹",
                "influence": "ç¸½æ ¼ç‚ºå¾Œé‹ï¼Œä¸»å®°48æ­²å¾Œçš„é‹å‹¢ï¼Œé—œä¿‚æ™šå¹´å¹¸ç¦"
            }
        }
        
        return meanings.get(ge_type, {"description": "æœªçŸ¥", "influence": "æœªçŸ¥"})
    
    def get_number_explanation(self, number):
        """ç²å–å…·é«”æ•¸å­—çš„è©³ç´°è§£é‡‹"""
        # ç°¡åŒ–ç‰ˆæ•¸å­—è§£é‡‹ï¼ˆå¯¦éš›æ‡‰è©²æœ‰81å€‹è©³ç´°è§£é‡‹ï¼‰
        explanations = {
            1: "å¤ªæ¥µä¹‹æ•¸ï¼Œè¬ç‰©é–‹æ³°ï¼Œç”Ÿç™¼ç„¡çª®ï¼Œåˆ©ç¥¿äº¨é€šã€‚ã€å¤§å‰ã€‘",
            2: "å…©å„€ä¹‹æ•¸ï¼Œæ··æ²Œæœªé–‹ï¼Œé€²é€€ä¿å®ˆï¼Œå¿—æœ›é›£é”ã€‚ã€å‡¶ã€‘",
            3: "ä¸‰æ‰ä¹‹æ•¸ï¼Œå¤©åœ°äººå’Œï¼Œå¤§äº‹å¤§æ¥­ï¼Œç¹æ¦®æ˜Œéš†ã€‚ã€å¤§å‰ã€‘",
            4: "å››è±¡ä¹‹æ•¸ï¼Œå¾…æ–¼ç”Ÿç™¼ï¼Œè¬äº‹æ…é‡ï¼Œä¸å…·ç‡Ÿè¬€ã€‚ã€å‡¶ã€‘",
            5: "äº”è¡Œä¿±æ¬Šï¼Œå¾ªç’°ç›¸ç”Ÿï¼Œåœ“é€šæš¢é”ï¼Œç¦ç¥‰ç„¡çª®ã€‚ã€å¤§å‰ã€‘",
            6: "å…­çˆ»ä¹‹æ•¸ï¼Œç™¼å±•è®ŠåŒ–ï¼Œå¤©è³¦ç¾å¾·ï¼Œå‰ç¥¥å®‰æ³°ã€‚ã€å¤§å‰ã€‘",
            7: "ä¸ƒæ”¿ä¹‹æ•¸ï¼Œç²¾æ‚åš´è¬¹ï¼Œå¤©è³¦ä¹‹åŠ›ï¼Œå‰æ˜Ÿé«˜ç…§ã€‚ã€å‰ã€‘",
            8: "å…«å¦ä¹‹æ•¸ï¼Œä¹¾åè‰®éœ‡ï¼Œå·½é›¢å¤å…Œï¼Œç„¡çª®ç„¡ç›¡ã€‚ã€å‰ã€‘",
            9: "å¤§æˆä¹‹æ•¸ï¼Œè˜Šæ¶µå‡¶éšªï¼Œæˆ–æˆæˆ–æ•—ï¼Œé›£ä»¥æŠŠæ¡ã€‚ã€å‡¶ã€‘",
            10: "çµ‚çµä¹‹æ•¸ï¼Œé›ªæš—é£„é›¶ï¼Œå¶æˆ–æœ‰æˆï¼Œå›é¡§èŒ«ç„¶ã€‚ã€å‡¶ã€‘",
            11: "æ—±è‹—é€¢é›¨ï¼Œæ¯æœ¨é€¢æ˜¥ã€‚æŒ½å›å®¶é‹ï¼Œé †åˆ©ç™¼å±•ã€‚ã€å¤§å‰ã€‘",
            12: "è–„å¼±ç„¡åŠ›ï¼Œå­¤ç«‹ç„¡æ´ï¼Œå¤–ç¥¥å…§è‹¦ï¼Œè¬€äº‹é›£æˆã€‚ã€å‡¶ã€‘",
            13: "å¤©è³¦å‰é‹ï¼Œèƒ½å¾—äººæœ›ï¼Œå–„ç”¨æ™ºè¬€ï¼Œå¿…ç²æˆåŠŸã€‚ã€å¤§å‰ã€‘",
            15: "ç¦å£½é›™å…¨ï¼Œå¯Œè²´æ¦®è¯ï¼Œæ¶µé¤Šé›…é‡ï¼Œå¾·é«˜æœ›é‡ã€‚ã€å¤§å‰ã€‘",
            16: "èƒ½ç²çœ¾æœ›ï¼Œæˆå°±å¤§æ¥­ï¼Œååˆ©é›™æ”¶ï¼Œç›Ÿä¸»å››æ–¹ã€‚ã€å¤§å‰ã€‘",
            17: "æ¬Šå¨å‰›å¼·ï¼Œçªç ´è¬é›£ï¼Œå¦‚èƒ½å®¹å¿ï¼Œå¿…ç²æˆåŠŸã€‚ã€å‰ã€‘",
            18: "æ¬Šå¨é¡¯é”ï¼Œåšå¾—ååˆ©ï¼Œä¸”é¤ŠæŸ”å¾·ï¼ŒåŠŸæˆåå°±ã€‚ã€å¤§å‰ã€‘",
            21: "å…ˆç¶“å›°è‹¦ï¼Œå¾Œå¾—å¹¸ç¦ï¼Œéœœé›ªæ¢…èŠ±ï¼Œæ˜¥ä¾†æ€’æ”¾ã€‚ã€å¤§å‰ã€‘",
            23: "æ—­æ—¥æ±å‡ï¼Œå£¯éº—å£¯è§€ï¼Œæ¬Šå¨æ—ºç››ï¼ŒåŠŸåæ¦®é”ã€‚ã€å¤§å‰ã€‘",
            24: "éŒ¦ç¹¡å‰ç¨‹ï¼Œé ˆé è‡ªåŠ›ï¼Œå¤šç”¨æ™ºè¬€ï¼Œèƒ½å¥å¤§åŠŸã€‚ã€å¤§å‰ã€‘",
            25: "å¤©æ™‚åœ°åˆ©ï¼Œå†å¾—äººå’Œï¼Œè¬›ä¿¡ä¿®ç¦ï¼Œå³å¯æˆåŠŸã€‚ã€å¤§å‰ã€‘",
            29: "æ™ºè¬€å„ªç§€ï¼Œè²¡åŠ›æ­¸é›†ï¼Œåèæµ·å…§ï¼Œæˆå°±å¤§æ¥­ã€‚ã€å¤§å‰ã€‘",
            31: "æ­¤æ•¸å¤§å‰ï¼Œååˆ©é›™æ”¶ï¼Œæ¼¸é€²å‘ä¸Šï¼Œå¤§æ¥­æˆå°±ã€‚ã€å¤§å‰ã€‘",
            32: "æ± ä¸­ä¹‹é¾ï¼Œé¢¨é›²éš›æœƒï¼Œä¸€èºä¸Šå¤©ï¼ŒæˆåŠŸå¯æœ›ã€‚ã€å¤§å‰ã€‘",
            33: "æ—­æ—¥å‡å¤©ï¼Œé¸é³³ç›¸æœƒï¼Œåèå¤©ä¸‹ï¼Œéš†æ˜Œè‡³æ¥µã€‚ã€å¤§å‰ã€‘",
            35: "ä¸­æ­£æº«å’Œï¼Œæ™ºé”é€šæš¢ï¼Œæ–‡æ˜ŒæŠ€è—ï¼Œå¥åŠŸæ´‹æ´‹ã€‚ã€å¤§å‰ã€‘",
            37: "é€¢å‡¶åŒ–å‰ï¼Œå‰äººå¤©ç›¸ï¼Œé¢¨èª¿é›¨é †ï¼Œç”Ÿæ„èˆˆéš†ã€‚ã€å¤§å‰ã€‘",
            39: "é›²é–‹è¦‹æœˆï¼Œé›–æœ‰å‹ç¢Œï¼Œå…‰æ˜å¦é€”ï¼ŒæŒ‡æ—¥å¯æœŸã€‚ã€å¤§å‰ã€‘",
            41: "å¤©è³¦å‰é‹ï¼Œå¾·æœ›å…¼å‚™ï¼Œç¹¼çºŒåŠªåŠ›ï¼Œå‰é€”ç„¡é™ã€‚ã€å¤§å‰ã€‘",
            45: "é †é¢¨æšå¸†ï¼Œæ–°ç”Ÿæ³°å’Œï¼Œæ’é™¤è¬é›£ï¼Œä¸€åˆ°æˆåŠŸã€‚ã€å¤§å‰ã€‘",
            47: "æœ‰è²´äººåŠ©ï¼Œå¯æˆå¤§æ¥­ï¼Œé›–é‡ä¸å¹¸ï¼Œæµ®æ²‰ä¸å¤§ã€‚ã€å‰ã€‘",
            48: "ç¾èŠ±è±å¯¦ï¼Œé¶´ç«‹é›ç¾¤ï¼Œååˆ©ä¿±å…¨ï¼Œç¹æ¦®å¯Œè²´ã€‚ã€å¤§å‰ã€‘",
        }
        
        if number > 81:
            number = number % 81
        if number == 0:
            number = 81
            
        if number in explanations:
            return explanations[number]
        else:
            luck = self.get_luck(number)
            return f"æ•¸ç†{number}ï¼Œé‹å‹¢ç‚º{luck}ã€‚"
    
    def analyze_name(self, full_name):
        """åˆ†æå§“å"""
        try:
            if not full_name or not full_name.strip():
                return "è«‹è¼¸å…¥æœ‰æ•ˆçš„å§“å"
            
            name = full_name.strip().replace(' ', '')
            
            # ç²å–ç­†ç•«
            strokes = self.get_name_strokes(name)
            
            if not strokes:
                return "ç„¡æ³•è§£æå§“åç­†ç•«"
            
            # è¨ˆç®—äº”æ ¼
            tiange = self.calculate_tiange(strokes)
            dige = self.calculate_dige(strokes)
            renge = self.calculate_renge(strokes)
            waige = self.calculate_waige(strokes)
            zongge = self.calculate_zongge(strokes)
            
            # ç”Ÿæˆå ±å‘Š
            report = self._generate_report(name, strokes, tiange, dige, renge, waige, zongge)
            
            return report
            
        except Exception as e:
            return f"ä¹å®®å§“åå­¸åˆ†æå‡ºç¾éŒ¯èª¤ï¼š{str(e)}"
    
    def _generate_report(self, name, strokes, tiange, dige, renge, waige, zongge):
        """ç”Ÿæˆåˆ†æå ±å‘Š"""
        
        report = f"""
{'='*80}
                    ğŸ”® ä¹å®®å§“åå­¸åˆ†æå ±å‘Š ğŸ”®
{'='*80}

ã€å§“åã€‘ï¼š{name}
ã€ç­†ç•«ã€‘ï¼š{' + '.join(map(str, strokes))} = {sum(strokes)} ç•«

{'='*80}
                          äº”æ ¼å‰–è±¡æ³•
{'='*80}

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€å¤©æ ¼ã€‘ï¼š{tiange} ç•«                                     â”‚
â”‚ äº”è¡Œå±¬æ€§ï¼š{self.get_wuxing(tiange)}                        â”‚
â”‚ å‰å‡¶è©•åƒ¹ï¼š{self.get_luck(tiange)}                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¼å±€å«ç¾©ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('å¤©æ ¼', tiange)['description']} â”‚
â”‚                                                          â”‚
â”‚ é‹å‹¢å½±éŸ¿ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('å¤©æ ¼', tiange)['influence']}   â”‚
â”‚                                                          â”‚
â”‚ æ•¸ç†è©³è§£ï¼š                                              â”‚
â”‚ {self.get_number_explanation(tiange)}                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€åœ°æ ¼ã€‘ï¼š{dige} ç•«                                     â”‚
â”‚ äº”è¡Œå±¬æ€§ï¼š{self.get_wuxing(dige)}                        â”‚
â”‚ å‰å‡¶è©•åƒ¹ï¼š{self.get_luck(dige)}                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¼å±€å«ç¾©ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('åœ°æ ¼', dige)['description']} â”‚
â”‚                                                          â”‚
â”‚ é‹å‹¢å½±éŸ¿ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('åœ°æ ¼', dige)['influence']}   â”‚
â”‚                                                          â”‚
â”‚ æ•¸ç†è©³è§£ï¼š                                              â”‚
â”‚ {self.get_number_explanation(dige)}                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€äººæ ¼ã€‘ï¼š{renge} ç•«ï¼ˆâ˜… ä¸»é‹ â˜…ï¼‰                         â”‚
â”‚ äº”è¡Œå±¬æ€§ï¼š{self.get_wuxing(renge)}                       â”‚
â”‚ å‰å‡¶è©•åƒ¹ï¼š{self.get_luck(renge)}                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¼å±€å«ç¾©ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('äººæ ¼', renge)['description']} â”‚
â”‚                                                          â”‚
â”‚ é‹å‹¢å½±éŸ¿ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('äººæ ¼', renge)['influence']}   â”‚
â”‚                                                          â”‚
â”‚ æ•¸ç†è©³è§£ï¼š                                              â”‚
â”‚ {self.get_number_explanation(renge)}                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€å¤–æ ¼ã€‘ï¼š{waige} ç•«                                     â”‚
â”‚ äº”è¡Œå±¬æ€§ï¼š{self.get_wuxing(waige)}                       â”‚
â”‚ å‰å‡¶è©•åƒ¹ï¼š{self.get_luck(waige)}                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¼å±€å«ç¾©ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('å¤–æ ¼', waige)['description']} â”‚
â”‚                                                          â”‚
â”‚ é‹å‹¢å½±éŸ¿ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('å¤–æ ¼', waige)['influence']}   â”‚
â”‚                                                          â”‚
â”‚ æ•¸ç†è©³è§£ï¼š                                              â”‚
â”‚ {self.get_number_explanation(waige)}                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€ç¸½æ ¼ã€‘ï¼š{zongge} ç•«                                    â”‚
â”‚ äº”è¡Œå±¬æ€§ï¼š{self.get_wuxing(zongge)}                      â”‚
â”‚ å‰å‡¶è©•åƒ¹ï¼š{self.get_luck(zongge)}                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¼å±€å«ç¾©ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('ç¸½æ ¼', zongge)['description']} â”‚
â”‚                                                          â”‚
â”‚ é‹å‹¢å½±éŸ¿ï¼š                                              â”‚
â”‚ {self.get_detailed_meaning('ç¸½æ ¼', zongge)['influence']}   â”‚
â”‚                                                          â”‚
â”‚ æ•¸ç†è©³è§£ï¼š                                              â”‚
â”‚ {self.get_number_explanation(zongge)}                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{'='*80}
                          äº”è¡Œç”Ÿå‰‹åˆ†æ
{'='*80}

å¤©æ ¼ï¼ˆ{self.get_wuxing(tiange)}ï¼‰â†’ äººæ ¼ï¼ˆ{self.get_wuxing(renge)}ï¼‰ï¼š{self._analyze_wuxing_relation(tiange, renge)}
äººæ ¼ï¼ˆ{self.get_wuxing(renge)}ï¼‰â†’ åœ°æ ¼ï¼ˆ{self.get_wuxing(dige)}ï¼‰ï¼š{self._analyze_wuxing_relation(renge, dige)}
äººæ ¼ï¼ˆ{self.get_wuxing(renge)}ï¼‰â†’ å¤–æ ¼ï¼ˆ{self.get_wuxing(waige)}ï¼‰ï¼š{self._analyze_wuxing_relation(renge, waige)}

{'='*80}
                          ç¶œåˆè©•åƒ¹
{'='*80}

âœ¦ å§“åç¸½è©•ï¼š
  æ ¹æ“šä¹å®®å§“åå­¸äº”æ ¼å‰–è±¡æ³•åˆ†æï¼Œæ‚¨çš„å§“åã€Œ{name}ã€ï¼š
  
  â€¢ å¤©æ ¼{tiange}ï¼ˆ{self.get_luck(tiange)}ï¼‰ï¼šå…ˆå¤©å®¶ä¸–é‹å‹¢{self._get_luck_description(self.get_luck(tiange))}
  â€¢ åœ°æ ¼{dige}ï¼ˆ{self.get_luck(dige)}ï¼‰ï¼šé’å¹´åŸºç¤é‹å‹¢{self._get_luck_description(self.get_luck(dige))}
  â€¢ äººæ ¼{renge}ï¼ˆ{self.get_luck(renge)}ï¼‰ï¼šä¸»é‹æ€§æ ¼å‘½é‹{self._get_luck_description(self.get_luck(renge))}
  â€¢ å¤–æ ¼{waige}ï¼ˆ{self.get_luck(waige)}ï¼‰ï¼šç¤¾äº¤äººéš›é‹å‹¢{self._get_luck_description(self.get_luck(waige))}
  â€¢ ç¸½æ ¼{zongge}ï¼ˆ{self.get_luck(zongge)}ï¼‰ï¼šæ™šå¹´ç¸½é«”é‹å‹¢{self._get_luck_description(self.get_luck(zongge))}

âœ¦ äº”è¡Œé…ç½®ï¼š
  å¤©æ ¼{self.get_wuxing(tiange)} - äººæ ¼{self.get_wuxing(renge)} - åœ°æ ¼{self.get_wuxing(dige)}
  {self._analyze_overall_wuxing(tiange, renge, dige)}

âœ¦ é–‹é‹å»ºè­°ï¼š
{self._get_lucky_advice(renge, zongge)}

{'='*80}

â€» èªªæ˜ï¼šä¹å®®å§“åå­¸æºè‡ªä¸­åœ‹å‚³çµ±æ˜“å­¸ï¼Œåƒ…ä¾›åƒè€ƒå¨›æ¨‚ï¼Œä¸å¯ç›¡ä¿¡ã€‚
        å§“åå›ºç„¶é‡è¦ï¼Œä½†å¾Œå¤©åŠªåŠ›æ›´ç‚ºé—œéµï¼

{'='*80}
"""
        return report
    
    def _analyze_wuxing_relation(self, num1, num2):
        """åˆ†æäº”è¡Œç”Ÿå‰‹é—œä¿‚"""
        wx1 = self.get_wuxing(num1)
        wx2 = self.get_wuxing(num2)
        
        # äº”è¡Œç›¸ç”Ÿï¼šæœ¨ç”Ÿç«ï¼Œç«ç”ŸåœŸï¼ŒåœŸç”Ÿé‡‘ï¼Œé‡‘ç”Ÿæ°´ï¼Œæ°´ç”Ÿæœ¨
        # äº”è¡Œç›¸å‰‹ï¼šæœ¨å‰‹åœŸï¼ŒåœŸå‰‹æ°´ï¼Œæ°´å‰‹ç«ï¼Œç«å‰‹é‡‘ï¼Œé‡‘å‰‹æœ¨
        
        sheng_map = {
            ('æœ¨', 'ç«'): 'ç›¸ç”Ÿï¼ˆæœ¨ç”Ÿç«ï¼‰', ('ç«', 'åœŸ'): 'ç›¸ç”Ÿï¼ˆç«ç”ŸåœŸï¼‰',
            ('åœŸ', 'é‡‘'): 'ç›¸ç”Ÿï¼ˆåœŸç”Ÿé‡‘ï¼‰', ('é‡‘', 'æ°´'): 'ç›¸ç”Ÿï¼ˆé‡‘ç”Ÿæ°´ï¼‰',
            ('æ°´', 'æœ¨'): 'ç›¸ç”Ÿï¼ˆæ°´ç”Ÿæœ¨ï¼‰'
        }
        
        ke_map = {
            ('æœ¨', 'åœŸ'): 'ç›¸å‰‹ï¼ˆæœ¨å‰‹åœŸï¼‰', ('åœŸ', 'æ°´'): 'ç›¸å‰‹ï¼ˆåœŸå‰‹æ°´ï¼‰',
            ('æ°´', 'ç«'): 'ç›¸å‰‹ï¼ˆæ°´å‰‹ç«ï¼‰', ('ç«', 'é‡‘'): 'ç›¸å‰‹ï¼ˆç«å‰‹é‡‘ï¼‰',
            ('é‡‘', 'æœ¨'): 'ç›¸å‰‹ï¼ˆé‡‘å‰‹æœ¨ï¼‰'
        }
        
        if (wx1, wx2) in sheng_map:
            return f"âœ“ {sheng_map[(wx1, wx2)]}ï¼Œå‰åˆ©"
        elif (wx1, wx2) in ke_map:
            return f"âœ— {ke_map[(wx1, wx2)]}ï¼Œä¸åˆ©"
        elif wx1 == wx2:
            return f"= åŒå±¬{wx1}ï¼Œæ¯”å’Œ"
        else:
            return "â—‹ é—œä¿‚å¹³å’Œ"
    
    def _analyze_overall_wuxing(self, tiange, renge, dige):
        """åˆ†ææ•´é«”äº”è¡Œé…ç½®"""
        wx_t = self.get_wuxing(tiange)
        wx_r = self.get_wuxing(renge)
        wx_d = self.get_wuxing(dige)
        
        # ç°¡åŒ–è©•åƒ¹
        if wx_t == wx_r == wx_d:
            return f"ä¸‰æ ¼åŒå±¬{wx_t}ï¼Œäº”è¡Œç´”ä¸€ï¼ŒåŠ›é‡é›†ä¸­ã€‚"
        else:
            return f"ä¸‰æ ¼äº”è¡Œå„ç•°ï¼Œéœ€æ³¨æ„å¹³è¡¡å”èª¿ã€‚"
    
    def _get_luck_description(self, luck):
        """ç²å–å‰å‡¶æè¿°"""
        desc_map = {
            "å¤§å‰": "å¤§å‰å¤§åˆ©ï¼Œé‹å‹¢æ˜Œéš†",
            "å‰": "å‰ç¥¥å¦‚æ„ï¼Œé‹å‹¢äº¨é€š",
            "åŠå‰": "å‰ä¸­å¸¶å‡¶ï¼Œéœ€è¬¹æ…è¡Œäº‹",
            "å‡¶": "å¤šæœ‰ä¸é †ï¼Œéœ€åŠ å€åŠªåŠ›",
            "å¹³": "å¹³ç©©å¹³æ·¡ï¼Œç„¡å¤§èµ·å¤§è½"
        }
        return desc_map.get(luck, "é‹å‹¢å¹³å¸¸")
    
    def _get_lucky_advice(self, renge, zongge):
        """ç²å–é–‹é‹å»ºè­°"""
        advice = []
        
        renge_luck = self.get_luck(renge)
        zongge_luck = self.get_luck(zongge)
        
        if renge_luck in ["å¤§å‰", "å‰"]:
            advice.append("  â€¢ äººæ ¼å‰åˆ©ï¼Œå®œç™¼æ®å€‹äººæ‰èƒ½ï¼Œç©æ¥µé€²å–")
        elif renge_luck == "å‡¶":
            advice.append("  â€¢ äººæ ¼æ¬ ä½³ï¼Œéœ€åŸ¹é¤Šè‰¯å¥½å“å¾·ï¼Œè¬™è™›å¾…äºº")
        
        if zongge_luck in ["å¤§å‰", "å‰"]:
            advice.append("  â€¢ ç¸½æ ¼å‰ç¥¥ï¼Œæ™šå¹´å¯æœŸï¼Œå®œé•·é è¦åŠƒ")
        elif zongge_luck == "å‡¶":
            advice.append("  â€¢ ç¸½æ ¼ä¸åˆ©ï¼Œéœ€æ³¨æ„æ™šå¹´è¦åŠƒï¼Œå¤šç©ç¦å¾·")
        
        advice.append("  â€¢ ä¿æŒç©æ¥µå¿ƒæ…‹ï¼Œå–„è¡Œç©å¾·ï¼Œå¯åŒ–å‡¶ç‚ºå‰")
        advice.append("  â€¢ å§“ååªæ˜¯åƒè€ƒï¼ŒåŠªåŠ›å¥®é¬¥æ‰æ˜¯æˆåŠŸé—œéµ")
        
        return "\n".join(advice)


# æ¸¬è©¦å‡½æ•¸
if __name__ == "__main__":
    analyzer = JiuGongNameAnalyzer()
    
    # æ¸¬è©¦æ¡ˆä¾‹
    test_names = ["ç‹å°æ˜", "æéº—è¯", "å¼µå‰", "é™³éœ"]
    
    for name in test_names:
        print(analyzer.analyze_name(name))
        print("\n" + "="*80 + "\n")
